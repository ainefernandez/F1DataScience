---
title: |
  \vspace{-1.8cm}
  \begin{center}
    \Huge Tarea4
  \end{center}
author: "Ainé Fernández"
date: "2023-11-16"
output:
  pdf_document:
    pandoc_args: [
      "--number-sections"
    ]
geometry: "left=0.5cm, right=0.5cm, top=0.5cm, bottom=1.6cm"
classoption: portrait,landscape
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Introducción 

El objetivo de este trabajo es la construcción de un modelo de regresión lineal múltiple que
explique y pronostique el precio de los automóviles en términos de variables explicativas
como su aceleración, su rendimiento en kilómetros por litro y la clase del vehículo, entre otras.
En particular, se desea conocer el efecto en el precio por el hecho de que el vehículo tenga la 
capacidad de desplazarse utilizando únicamente electricidad, es decir, vehículos eléctricos e híbridos.

# Resumen del Artículo

La base de datos de este trabajo es la utilizada en el artículo:

Lim, D-J, Jahromi, S. R., Anderson, T.R. y Tudorie, A-A (2015). Comparing technological advancement
of hybrid electric vehicles (HEV) in different market segments, Technological Forecasting and Social
Change, 97, pp. 140-153.

Lim et al. (2015) estudian la evolución del precio de vehículos híbridos y eléctricos en diferentes segmentos del mercado relacionados a la clase del vehículo que está relacionada al tamaño (Two-seaters, Compact, Midsize, Large, SUV, Minivan y Pickup) concluyendo que existe una diversificación de los vehículos híbridos y eléctricos en el segmento Midsize que podría ser una amenaza para los vehículos tradicionales en los segmentos de menor tamaño (Two-seaters y Compact).

# Descripción de la Variable Dependiente y Variables Explicativas

La variable dependiente es el precio del vehículo sugerido por el fabricante y se encuentra en la base de datos con el nombre msrp (manufacturers suggested retail price). Los precios están expresados en dólares equivalentes del 2013.

Las variables explicativas son las siguientes:

1)year: año modelo del vehículo (1997, 2000, 2001, 2002, ..., 2013).
2)accelrate: tiempo en segundos que le toma al vehículo en recorrer 100 km.
3)mpg: el rendimiento del vehículo en millas recorridas por galón de gasolina.
4)mpgmpge: el rendimiento del vehículo equivalente en millas por galón de gasolina equivalente en energía eléctrica.
5)carclass: la clase del vehículo (Two-seaters, Compact, Midsize, Large, SUV, Minivan y Pickup).
6)carclass_id: igual que carclass pero con etiquetas numéricas.
 

```{r,message=FALSE,warning=FALSE,echo=FALSE}
library(ggplot2)
library(MASS)
library(car)
library(lmtest)
library(tseries)
library(stargazer)
data<-read.csv("datosFit.csv")
#data
new_data<-read.csv("datosFin.csv")
#data
#str(data)
```

# Generación de Nuevas Variables Explicativas y Análisis Exploratorio

Se construyeron las nuevas variables explicativas:

1)old: es la antigüedad del vehículo (2014-year).
2)elec: indicadora para identificar a los vehículos eléctricos e híbridos de los de combustión. Se tienen un total de 10 vehículos eléctricos e híbridos.
3)kml: se obtienen el rendimiento en kilómetros por litro transformando la variable mpg
4)kml2: el cuadrado de kml
5)lkm: el recíproco de kml, es decir, litros por km.
6)lkm2: el cuadrado de lkm.
7)Para la variable dependiente msrp se dividió entre 1000 para expresarla en miles de dólares.

En el análisis exploratorio se construyeron diagramas de caja y brazos (boxplots) de la variable dependiente contra las variables categóricas de la clase del vehículo carclass y el año year:

1)Boxplot msrp versus carclass: la categoría Large (L) tiene precios muy altos en comparación con as otras categorías. La categoría SUV presenta la mayor variabilidad en sus precios y la clase Two-seater (TS) presenta una variabilidad muy baja en sus precios. En general, se nota un incremento en la mediana de los precios con respecto al tamaño del vehículoen su categoría (Two-seater, Compact, Midsize, Minivan, Pickup, SUV y Large).

2)Boxplot msrp versus year: en general, la variabilidad de los precios aumenta con el año del vehículo y la distribución de los precios presentan sesgos hacia la derecha.

En la matriz de diagramas de dispersión la variable accelrate presenta asociación lineal clara con la variable dependiente msrp.

El histograma de la variable dependiente msrp presenta un claro sesgo hacia la derecha.

En la matriz de correlaciones, se pueden observar correlaciones muy altas entre la variable kml, su cuadrado y su recíproco. 
```{r,fig.width=8,fig.height=3.5,results="asis",fig.align="center",echo=FALSE,fig.cap="Boxplots de la variable dependiente msrp contra carclass y year"}
#Generación de factores para las variables categóricas y de nuevas variables que son transformaciones de variables explicativas
#Factores
## carclass
data$carclass_id<-factor(data$carclass_id)
data$carclass<-factor(data$carclass)

#Transformaciones de variables cuantitativas
##antigüedad 
old<-2014-data$year
data[,"old"]<-old
##independencia electrica 
elec<-as.integer(data$mpg!=data$mpgmpge)
data[,"elec"]<-elec
data$elec<-factor(data$elec)

##variable dependiente msrp en miles de dólares
data$msrp<-data$msrp/1000
##km por litro
data[,"kml"]<-0.425*data$mpg
##km por litro al cuadrado
data[,"kml2"]<-data$kml^2
##consumo de litros de combustible por km (litros por km)
data[,"lkm"]<-1/data$kml
##litros por km al cuadrado
data[,"lkm2"]<-data$lkm^2

#Análisis Exploratorio
numericdata<-data[,c(4,5,10,12,13,14,15)]
stargazer(numericdata,header=FALSE,title="Estadísticas de las variables")

##Boxplots de la variable dependiente msrp versus las variables categóricas de la clase del auto (carclass) y el año del auto (year) 
par(mfrow=c(1,2))
boxplot(data$msrp~data$carclass)
boxplot(data$msrp~data$year)

##Matriz de correlaciones entre las variables cuantitativas
cor.matrix<-cor(data[,c(4,5,10,12,13,14,15)])
stargazer(cor.matrix,header=FALSE,title="Matriz de Correlación")


```


```{r,fig.width=8,fig.height=3.5,results="asis",fig.align="center",echo=FALSE,fig.cap="Histogramas de las variables dependientes msrp y log(msrp)"}
##Histograma de la variable dependiente
par(mfrow=c(1,2))
hist(data$msrp,freq=FALSE,main="Histograma de msrp",xlab = "msrp")
hist(log(data$msrp),freq=FALSE,main="Histograma de log(msrp)",xlab = "log(msrp)")
```

# Construcción del Modelo de Regresión Lineal Múltiple
## Modelo de regresión múltiple para la variable dependiente msrp

Se implementó selección hacia atrás descartando variables no significativas de acuerdo a su valor p (mayor a 0.05 para ser eliminada). Se llegó a un modelo final reducido con las variables explicativas accelrate, carclassL, carclassSUV, carclassTS, old, elec1, kml y las interacciones elec1*kml y old*kml con una R2 de 0.66. Las gráficas de validación del modelo muestran problemas en el supuesto de normalidad de los errores además de presentar a las observaciones 19,52,65 y 118 como observaciones atípicas e influyentes.
Además, la prueba de Breusch-Pagan rechaza la homoscedasticidad de los errores y la prueba de Jarque-Bera también rechaza la hipótesis nula de asimetría cero y curtosis 3.

```{r,fig.width=8,fig.height=5,fig.align="center",echo=FALSE}
#Generación de la matriz de diseño X incluyendo las interacciones elec*accelrate y elec*kml
data2<-model.matrix(~msrp+accelrate+carclass+old+elec+kml+elec*accelrate+elec*kml,data=data)
#head(data2)
data2<-data2[,-c(1)]
data2<-as.data.frame(data2)

# Modelo inicial para llevar a cabo selección hacia atrás
modelocompletoinicial<-lm(msrp~accelrate+carclassL+carclassM+carclassMV+carclassPT+carclassSUV+carclassTS+old+elec1+kml+elec1*accelrate+elec1*kml+old*kml,data=data2)
#summary(modelocompletoinicial)

#Selección hacia atrás
## eliminando carclassPT
modelored1<-lm(msrp~accelrate+carclassL+carclassM+carclassMV+carclassSUV+carclassTS+old+elec1+kml+elec1*accelrate+elec1*kml+old*kml,data=data2)
#summary(modelored1)

## eliminando accelrate:elec1
modelored2<-lm(msrp~accelrate+carclassL+carclassM+carclassMV+carclassSUV+carclassTS+old+elec1+kml+elec1*kml+old*kml,data=data2)
#summary(modelored2)

## eliminando carclassM
modelored3<-lm(msrp~accelrate+carclassL+carclassMV+carclassSUV+carclassTS+old+elec1+kml+elec1*kml+old*kml,data=data2)
#summary(modelored3)
## eliminando carclassMV se llega a un modelo candidato a ser el modelo final
modelored4<-lm(msrp~accelrate+carclassL+carclassSUV+carclassTS+old+elec1+kml+elec1*kml+old*kml,data=data2)
#summary(modelored4)

###heteroscedasticidad: prueba de Breusch-Pagan
#bptest(modelored4)
###normalidad: prueba de Jarque-Bera
resstdred4<-rstandard(modelored4)
#jarque.bera.test(resstdred4)
###observaciones atípicas e influyentes
#data[c(19,52,65,118),]
#vif(modelored4,type="predictor")
```



```{r,fig.width=8,fig.height=5,fig.align="center",echo=FALSE,fig.cap="Gráficas de validación del modelored4"}
## Validación del modelo candidato final modelored4
par(mfrow=c(2,2))
plot(modelored4)
```




### Transformación Box-Cox
La siguiente gráfica sugiere una transformación logarítmica de la variable dependiente.

```{r,echo=FALSE,fig.width=5,fig.height=3.5,fig.align="center",fig.cap="Gráfica Box-Cox"}
boxcox(modelored4)
```

## Modelo de regresión para msrp inlcuyendo efectos no lineales: km por litro al cuadrado, litros por km y litros por km al cuadrado

Se consideró mejorar el ajuste del modelo considerando transformaciones no lineales (cuadrados y recíprocos) de la variable km por litro. Se hizo selección hacia atrás pero los factores de inflación de la varianza presentan valores demasiado altos (58.13 y 97.10) indicando claros síntomas de multicolinealidad haciendo que el modelo no quede validado.

```{r,fig.width=8,fig.height=5,fig.align="center",echo=FALSE}
#Generación de la matriz de diseño X incluyendo las interacciones elec*accelrate, elec*kml, km por litro al cuadrado, litros por km y litros por km al cuadrado
data3<-model.matrix(~msrp+accelrate+carclass+old+elec+kml+elec*accelrate+elec*kml+kml2+lkm+lkm2,data=data)
#head(data3)
data3<-data3[,-c(1)]
data3<-as.data.frame(data3)

#Modelo inicial para llevar a cabo selección hacia atrás
modelocompletoinicialqua<-lm(msrp~accelrate+carclassL+carclassM+carclassMV+carclassPT+carclassSUV+carclassTS+old+elec1+elec1*accelrate+elec1*lkm+old*lkm+lkm+lkm2,data=data3)
#summary(modelocompletoinicialqua)

#Selección hacia atrás empezando con los términos de interacción y términos no lineales
##eliminando accelrate:elec1
modelored1qua<-lm(msrp~accelrate+carclassL+carclassM+carclassMV+carclassPT+carclassSUV+carclassTS+old+elec1+elec1*lkm+old*lkm+lkm+lkm2,data=data3)
#summary(modelored1qua)

##eliminando carclassM
modelored2qua<-lm(msrp~accelrate+carclassL+carclassMV+carclassPT+carclassSUV+carclassTS+old+elec1+elec1*lkm+old*lkm+lkm+lkm2,data=data3)
#summary(modelored2qua)

##eliminando carclassSUV
modelored3qua<-lm(msrp~accelrate+carclassL+carclassMV+carclassPT+carclassTS+old+elec1+elec1*lkm+old*lkm+lkm+lkm2,data=data3)
#summary(modelored3qua)

##eliminando carclassMV
modelored4qua<-lm(msrp~accelrate+carclassL+carclassPT+carclassTS+old+elec1+elec1*lkm+old*lkm+lkm+lkm2,data=data3)
#summary(modelored4qua)

##eliminando elec1:lkm
modelored5qua<-lm(msrp~accelrate+carclassL+carclassPT+carclassTS+old+elec1+old*lkm+lkm+lkm2,data=data3)
#summary(modelored5qua)

##eliminando elec1
modelored6qua<-lm(msrp~accelrate+carclassL+carclassPT+carclassTS+old+old*lkm+lkm+lkm2,data=data3)
#summary(modelored6qua)


###observaciones atípicas e influyentes
#data[c(29,65,105,118),]
###multicolinealidad: Factores de inflación de la varianza VIF
#vif(modelored6qua,type="predictor")
###heteroscedasticidad: prueba de Breusch-Pagan
#bptest(modelored6qua)
###normalidad: prueba de Jarque-Bera
resstdqua<-rstandard(modelored6qua)
###prueba de Jarque-Bera es sensible a observaciones atípicas
#jarque.bera.test(resstdqua)

```


```{r,fig.width=8,fig.height=5,fig.align="center",echo=FALSE,fig.cap="Gráficas de validación del modelored6qua"}
## Validación del modelo candidato final modelored6qua
par(mfrow=c(2,2))
plot(modelored6qua)
```



## Modelo de regresión múltiple para la variable transformada logaritmo natural de msrp log(msrp)

Dado el sesgo hacia la derecha que presenta el histograma de la variable dependiente y los resultados de la prueba de Jarque-Bera del primer modelo, se consideró utilizar un modelo en el cual la variable dependiente sea transformada. Se utilizó la transformación de logaritmo natural de msrp y se selección el modelo por selección hacia atrás llegando a un modelo candidato final con las variables explicativas accelrate, carclassL, carclassSUV, carclassTS, old, elec1, kml y las interacciones elec1*kml y old*kml. Se tiene una R2 de 0.63 y el modelo queda validado en las pruebas de Breusch-Pagan y VIF. Para la prueba de Jarque-Bera es necesario eliminar el atípico 29 de dicha prueba. Este es nuestro modelo final validado. Las observaciones atípicas e influyentes son: 29, 65, 105 y 118 correspondientes a los ids 21, 30, 36 y 37. Se trata de un Crown (M en 62290 dólares), Cadillac Scalade (SUV en 78932 dólares), Lexus LS600h/hL (M en 118543 dólares) y un Accord (M en 15343) siendo los tres primeros autos muy caros para su clase y el Accord muy barato. Se generó una variable indicadora para los tres primeros ind29_65_118 y se incluyó en el modelo final incrementándose la R2 a 0.71 pero se rechaza el supuesto de homoscedasticidad en la prueba de Breusch-Pagan por lo que no se considera como el modelo final.
```{r,fig.width=8,fig.height=3.5,fig.align="center",echo=FALSE}
#Variable dependiente log(msrp) logmsrp
data2[,"logmsrp"]<-log(data2$msrp)

#Modelo inicial para llevar a cabo selección hacia atrás
modelocompletoiniciallog<-lm(logmsrp~accelrate+carclassL+carclassM+carclassMV+carclassPT+carclassSUV+carclassTS+old+elec1+kml+elec1*accelrate+elec1*kml+old*kml,data=data2)
#summary(modelocompletoiniciallog)

#Selección hacia atrás empezando con los términos de interacción
##eliminando accelrate:elec1
modelored1log<-lm(logmsrp~accelrate+carclassL+carclassM+carclassMV+carclassPT+carclassSUV+carclassTS+old+elec1+kml+elec1*kml+old*kml,data=data2)
#summary(modelored1log)

##eliminando carclassM
modelored2log<-lm(logmsrp~accelrate+carclassL+carclassMV+carclassPT+carclassSUV+carclassTS+old+elec1+kml+elec1*kml+old*kml,data=data2)
#summary(modelored2log)

##eliminando carclassMV
modelored3log<-lm(logmsrp~accelrate+carclassL+carclassPT+carclassSUV+carclassTS+old+elec1+kml+elec1*kml+old*kml,data=data2)
#summary(modelored3log)

##eliminando carclassPT
modelored4log<-lm(logmsrp~accelrate+carclassL+carclassSUV+carclassTS+old+elec1+kml+elec1*kml+old*kml,data=data2)
#summary(modelored4log)


###observaciones atípicas e influyentes
#data[c(29,65,105,118),]
###multicolinealidad: Factores de inflación de la varianza VIF
#vif(modelored4log,type="predictor")
###heteroscedasticidad: prueba de Breusch-Pagan
#bptest(modelored4log)
###normalidad: prueba de Jarque-Bera
resstd<-rstandard(modelored4log)
###prueba de Jarque-Bera es sensible a observaciones atípicas
#jarque.bera.test(resstd[-c(29)])

ygorroprecio<-exp(modelored4log$fitted.values+0.5*(.3067^2))
#cor(ygorroprecio,data2$msrp)^2
###Generando variable indicadora para atípicos e influyentes
ind29_65_118<-rep(0,nrow(data2))
ind29_65_118[c(29,65,118)]<-1
data2b<-data2
data2b[,"ind29_65_118"]<-ind29_65_118

#Modelo agregando indicadora de atípicos e influyentes 
modelored4logb<-lm(logmsrp~accelrate+carclassL+carclassSUV+carclassTS+old+elec1+kml+elec1*kml+old*kml+ind29_65_118,data=data2b)
#summary(modelored4logb)

## Validación del modelo candidato final modelored4log
resstdb<-rstandard(modelored4logb)
###normalidad: prueba de Jarque-Bera
#jarque.bera.test(resstdb)
###heteroscedastidad: prueba de Breusch-Pagan
#bptest(modelored4logb)
###multicolinealidad: Factores de inflación de la varianza VIF
#vif(modelored4logb,type="predictor")

```


```{r,fig.width=8,fig.height=5,fig.align="center",echo=FALSE,fig.cap="Gráficas de validación del modelo4log"}
## Validación del modelo candidato final modelored4log
par(mfrow=c(2,2))
plot(modelored4log)
```




## Resultados de los modelos de regresión 

A continuación se presenta una tabla comparando los resultados de los diferentes modelos con las pruebas de validación Breusch-Pagan, Jarque-Bera y el máximo de los factores de inflación de la varianza (VIF). 

```{r, results="asis",comment=FALSE,echo=FALSE}
stargazer(modelored4log,modelored4logb,modelored6qua,modelored4,no.space = TRUE,object.names = TRUE,add.lines=list(c("Breusch-Pagan p-value (Homosk. test)","0.0834","0.0170","0.0176","0.0324"),c("Jarque-Bera p-value (sk.test)","0.1135 (rm29)","0.6775","2.2e-16","2.2e-16"),c("Max.VIF","4.50","4.51","97.10","4.50")),title = "Resultados de los modelos de regresión")
                                                                        
```

\newpage

# Predicción utilizando el modelo final validado para log(msrp): modelored4log

Utilizando el modelo final validado para log(msrp) se pronosticaron los precios de 13 nuevos vehículos no incluidos en la base original. El modelo generó intervalos de predicción que incluyeron los valores de los precios de 11 de los 13 vehículos. Los vehículos 4 y 5 fueron aquellos precios no quedaron dentro de los intervalos de predicción. En la primera columna de la tabla de las predicciones son los valores reales de los precios, en la segunda columna están las predicciones, luego el límite inferior del intervalo de confianza y por último el límite superior del intervalo de confianza.  

```{r,fig.width=8,fig.height=3.5,fig.align="center",echo=FALSE,results='asis'}
#cargando la base de datos para predicción con 13 observaciones
new_data<-read.csv("datosFin.csv")
new_data_original<-new_data

#generando la mismas variables con las cuales se ajustó el modelo final modelored4log
new_data$carclass_id<-factor(new_data$carclass_id)
new_data$carclass<-factor(new_data$carclass)
##antigüedad 
oldnew<-2014-new_data$year
new_data[,"old"]<-oldnew
##independencia eléctrica 
elecnew<-as.integer(new_data$mpg!=new_data$mpgmpge)
new_data[,"elec"]<-elecnew
new_data$elec<-factor(new_data$elec)
##msrp en miles de dólares
new_data$msrp<-new_data$msrp/1000
##km por litro
new_data[,"kml"]<-0.425*new_data$mpg
##km por litro al cuadrado
new_data[,"kml2"]<-new_data$kml^2
##litros por km
new_data[,"lkm"]<-1/new_data$kml
##litros por km al cuadrado
new_data[,"lkm2"]<-new_data$lkm^2

#Generación de la matriz de diseño X incluyendo las interacciones elec*accelrate, elec*kml
#str(new_data)
datanew<-model.matrix(~msrp+accelrate+carclass+old+elec+kml+elec*accelrate+elec*kml,data=new_data)
datanew<-as.data.frame(datanew)

#Predicción puntual e intervalos de predicción para log(msrp)
predictnew<-predict(modelored4log,newdata=datanew,interval="prediction")
#predictnew

# Predicción por intervalos para msrp
#exp(predictnew[,2:3])
#new_data_original$msrp/1000

# Predicción puntual para msrp ya que log(msrp) se supone normal entonces msrp se distribuye lognormal
predictprecio<-exp(predictnew[,1]+0.5*(.3067^2))
intconf<-cbind(new_data_original$msrp/1000,predictprecio,exp(predictnew[,2:3]))
colnames(intconf)<-c("Valor real","Predicción","lwr","upr")
stargazer(intconf,header=FALSE,title = "Intervalos de confianza de las predicciones")

# La observación 4 en la base de datos de predicción es un C-max que se trata más bien de una minivan pero se le asignó (erróneamente) la clase L (Large)
# Modificando el valor de carclassL de 1 a 0 para la observación 4 C-max. La indicadora carclassMV no es una variable en el modelo final modelored4log


```


La observación 4 en la base de datos de predicción es un C-max que se trata más bien de una minivan pero se le asignó (erróneamente) la clase L (Large). Modificando el valor de carclassL de 1 a 0 para la observación 4 C-max (la indicadora carclassMV no es una variable en el modelo final modelored4log) ya se logró que el precio cayera dentro del intervalo de predicción. La observación 5 es un A5 BSG (M en 11849 dólares 2009) siendo un precio muy bajo para un Audi que además parece ser que el sistema BSG tiene algo que ver con la posibilidad de un mejor rendimiento de combustible.

```{r,echo=FALSE,results='asis',fig.width=8,fig.height=3.5,fig.align="center",fig.cap="Predicciones"}
datanewcmaxnoL<-datanew
datanewcmaxnoL[4,"carclassL"]<-0
predictnewcmaxnoL<-predict(modelored4log,newdata=datanewcmaxnoL,interval="prediction")
#predictnewcmaxnoL

##Nueva predicción por intervalos
#exp(predictnewcmaxnoL[,2:3])
#new_data_original$msrp/1000

##Nueva predicción puntual
predictpreciocmaxnoL<-exp(predictnewcmaxnoL[,1]+0.5*(.3067^2))
intconf2<-cbind(new_data_original$msrp/1000,predictpreciocmaxnoL,exp(predictnewcmaxnoL[,2:3]))
colnames(intconf2)<-c("Valor real","Predicción","lwr","upr")
stargazer(intconf2,header=FALSE,title = "Intervalos de confianza de las predicciones con la observación 4 corregida")
par(mfrow=c(1,2))
plot(new_data_original$msrp/1000,predictprecio,main="Predicciones originales")
plot(new_data_original$msrp/1000,predictpreciocmaxnoL, main = "Predicciones con la observación 4 corregida")

```


## Bondad de las predicciones 

Se presenta la correlación entre los valores observados y sus predicciones, el RMSE(Raíz cuadrada del promedio de los errores de predicción al cuadrado), el MAE(Promedio de los errores de predicción en valor absoluto) y el MAPE (Promedio de los errores porcentuales de predicción en valor absoluto). 

```{r,echo=FALSE,results='asis'}
#Bondad de las predicciones
##Correlación entre los valores observados y sus predicciones
corp<-cor(new_data_original$msrp/1000,predictpreciocmaxnoL)^2
#RMSE: Root Mean Squared Error (Raíz cuadrada del promedio de los errores de predicción al cuadrado)
RMSE<-sqrt(mean((new_data_original$msrp/1000-predictpreciocmaxnoL)^2))
# MAE: Mean Absolute Error (Promedio de los errores de predicción en valor absoluto)
MAE<-mean(abs(new_data_original$msrp/1000-predictpreciocmaxnoL))
# MAPE: Mean Absolute Percentual Error (Promedio de los errores porcentuales de predicción en valor absoluto)
MAPE<-mean(abs(new_data_original$msrp/1000-predictpreciocmaxnoL)/(new_data_original$msrp/1000))
bondad<-cbind(corp,RMSE,MAE,MAPE)
stargazer(bondad,header=FALSE,title = "Bondad de las predicciones ")

```
\newpage

# Conclusiones

Se logró construir un modelo de regresión múltiple para explicar y pronosticar el precio de los vehículos. Dicho modelo tiene la siguiente ecuación ajustada:

$$\widehat{logmsrp}=3.0990+0.0749accelrate+0.6097carclassL+0.1768carclassSUV-0.4515carclassTS-0.0682old-1.2829elec1-0.0340kml+0.0828elec1*kml+0.0044old*kml$$

Dado que el modelo es para logmsrp, la interpretación de los coeficientes estimados de regresión es la siguiente (ceteris paribus las demás variables):

1)Por cada segundo que tarda de más en llegar a 100 km, el precio se incrementa, en promedio, 7.49%.
2)Por un vehículo clase Large (L) el precio aumenta, en promedio, 60.97% con respecto a la base que son vehículos Compact (C), Minivan (MV) y Pickup (PT).
3)Por un vehículo clase SUV el precio aumenta, en promedio, 17.68% con respecto a la base que son vehículos Compact (C), Minivan (MV) y Pickup (PT).
4)Por un vehículo clase TS (Two-seated) el precio dismminuye, en promedio, 45.15% con respecto a la base que son vehículos Compact (C), Minivan (MV) y Pickup (PT).
5)Por cada año de antigüedad el precio disminuye, en promedio, 6.82% siendo la disminución menor en 0.44% por cada unidad de sus km por litro.
6)La reducción promedio en el precio de un vehículo eléctrico depende de su rendimiento en km por litro reduciendo 128.29% en 8.28% por cada unidad en km por litro.

El modelo predice adecuadamente en términos de intervalos de predicción aunque puntualmente puede cometer errores de predicción con un MAPE de 21.19% para los 13 vehículos en la base de predicción.



